<link rel="import" href="../polymer/polymer.html">

<dom-module id="last-fm">
  <style>
    :host {
      display: block;
      width: 350px;
    }
  </style>
  <template></template>
  <script>
    Polymer({
      is: 'last-fm',
      properties: {
        /**
         * The API key used to authenticate with Last.fm's API
         * This should ideally be changed to your own key.
         *
         * @attribute apiKey
         * @type String
         * @default ''
         */
        apiKey: {
          type: String,
          value: '',
          notify: true
        },
        /**
         * The `user` attribute is the only mandatory parameter.
         *
         * @attribute user
         * @type String
         * @default ''
         */
        user: {
          type: String,
          value: '',
          notify: true
        }
      },
      /**
       * The `_importModule` method loads all the modules specified in the "modules" attribute.
       *
       * @method _importModule
       * @private
       */
      _importModule: function(modules) {
        modules.map(function(module) {
          var moduleName = 'last-fm-' + module;
          this.importHref(this.resolveUrl(moduleName + '.html'), function() {
            console.log(moduleName + ' imported!');
            var content = Polymer.dom(this).node,
                element = document.createElement(moduleName);

            element.user = Polymer.dom(this).node.user;
            element.apiKey = Polymer.dom(this).node.apiKey;
            //element.setAttribute('user', '[[user]]');
            //element.setAttribute('api-key', '[[apiKey]]');

            content.appendChild(element);
          }, function() {
            console.log('error importing module ' + modules);
          });
        }.bind(this));
      },
      attached: function() {
        var modules = this.getAttribute('modules').split(' ');
        this._importModule(modules);
      }
    });
  </script>
</dom-module>

