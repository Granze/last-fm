<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

<dom-module id="last-fm-artists">
  <style>
    :host {
      display: block;
      width: 350px;
      color: #333;
      border-radius: 0 0 4px 4px;
      font-family: Arial, Helvetica, sans-serif;
      text-align: left;
      background-color: #fff;
    }
    a {
      color: #333;
    }
    a:hover {
      text-decoration: underline;
    }
    .card {
      border: 1px solid #ccc;
    }
    .card section {
      margin: 0 20px;
    }
  </style>

  <template>

    <iron-ajax auto id="userajax"
               url="http://ws.audioscrobbler.com/2.0/"
               params="[[_ajaxParams(user, apiKey)]]"
               handleas="json" last-response="{{artists}}">
    </iron-ajax>

    <ol class="card">
      <template is="dom-if" if="[[!artists.error]]">
        <section class="artists">
          <ol>
            <template is="dom-repeat" items="{{artists.topartists.artist}}">
              <li>
                <p><span>[[item.name]]</span> - <span>[[item.playcount]]</span></p>
              </li>
            </template>
          </ol>
        </section>
      </template>
    </div>
  </template>
  <script>
    Polymer({
      is: 'last-fm-artists',
      /**
       * The `ajaxParams` method pass some parameters to the iron-ajax component
       *
       * @method ajaxParams
       * @private
       */
      _ajaxParams: function(user, apiKey) {
        return  {
          method: 'user.getTopArtists',
          user: user,
          api_key: apiKey,
          format: 'json',
          limit: 5
        };
      }
    });
  </script>
</dom-module>

